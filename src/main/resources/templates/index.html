<!DOCTYPE html>
<html lang="en">
<head>
    <th:block th:replace="component/config :: config"></th:block>
    <script src="https://code.jquery.com/jquery-3.6.1.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <meta charset="UTF-8">
    <title>Title</title>
</head>

<body>
<div th:replace="component/header :: header"></div>
<div th:replace="component/nav :: nav"></div>
<div class="container">
    <div id="demo" class="carousel slide" data-bs-ride="carousel" style="width: 1300px;">
        <div class="carousel-indicators">
            <button type="button" data-bs-target="#demo" data-bs-slide-to="0" class="active" style="background-color: gray"></button>
            <button type="button" data-bs-target="#demo" data-bs-slide-to="1" style="background-color: gray"></button>
            <button type="button" data-bs-target="#demo" data-bs-slide-to="2" style="background-color: gray"></button>


        </div>

        <div class="carousel-inner">
            <div class="carousel-item active">
                <img src="/img/Slides1.gif" class="d-block" href="/adminBoard/list">
            </div>
            <div class="carousel-item">
                <img src="/img/Slides2.png" class="d-block" href="/memberBoard/list">
            </div>
            <div class="carousel-item">
                <img src="/img/Slides3.png" class="d-block" href="/market/list">
            </div>
        </div>

        <button class="carousel-control-prev" type="button" data-bs-target="#demo" data-bs-slide="prev">
            <span class="carousel-control-prev-icon"></span>
        </button>
        <button class="carousel-control-next" type="button" data-bs-target="#demo" data-bs-slide="next">
            <span class="carousel-control-next-icon" style="position: absolute;"></span>
        </button>
    </div>
    //d
    <div style="margin-top: 50px;">
        <h1>주간코디예보</h1>
        <div style="display: none;" id="weatherResult"></div>
        <div style="display: flex;" id="temperatureResult"></div>
        <div style="display: flex;" id="weather2Result"></div>
        <div style="display: flex;" id="locationResult"></div>
        <div style="display: flex; margin-top: -200px; margin-left: 400px;" id="icon"></div>

        <div id="day-buttons" style="margin-left: -15px; margin-top: 15px;">
            <button id="monday-button" class="day-button" onclick="toggleButton('monday-button')">
                <img id="monday-img-0" class="day-img" src="/img/week/monday_button_0.png">
                <img id="monday-img-1" class="day-img" src="/img/week/monday_button_1.png">
            </button>

            <button id="tuesday-button" class="day-button" onclick="toggleButton('tuesday-button')">
                <img id="tuesday-img-0" class="day-img" src="/img/week/tuesday_button_0.png">
                <img id="tuesday-img-1" class="day-img" src="/img/week/tuesday_button_1.png">
            </button>

            <button id="wednesday-button" class="day-button" onclick="toggleButton('wednesday-button')">
                <img id="wednesday-img-0" class="day-img" src="/img/week/wednesday_button_0.png">
                <img id="wednesday-img-1" class="day-img" src="/img/week/wednesday_button_1.png">
            </button>

            <button id="thursday-button" class="day-button" onclick="toggleButton('thursday-button')">
                <img id="thursday-img-0" class="day-img" src="/img/week/thursday_button_0.png">
                <img id="thursday-img-1" class="day-img" src="/img/week/thursday_button_1.png">
            </button>

            <button id="friday-button" class="day-button" onclick="toggleButton('friday-button')">
                <img id="friday-img-0" class="day-img" src="/img/week/friday_button_0.png">
                <img id="friday-img-1" class="day-img" src="/img/week/friday_button_1.png">
            </button>

            <button id="saturday-button" class="day-button" onclick="toggleButton('saturday-button')">
                <img id="saturday-img-0" class="day-img" src="/img/week/saturday_button_0.png">
                <img id="saturday-img-1" class="day-img" src="/img/week/saturday_button_1.png">
            </button>

            <button id="sunday-button" class="day-button" onclick="toggleButton('sunday-button')">
                <img id="sunday-img-0" class="day-img" src="/img/week/sunday_button_0.png">
                <img id="sunday-img-1" class="day-img" src="/img/week/sunday_button_1.png">
            </button>
            <h4 style="display: block; margin-top: -50px; margin-left: 1200px">
                <a href="/adminBoard/list" style="text-decoration: none;  font-size: 15px; color: black;">더 보기 ></a>
            </h4>

        </div>
    </div>


</div>
</div>
<div th:replace="component/footer :: footer"></div>
</body>
<script>
    function initButtons() {
        // 현재 요일에 해당하는 버튼의 이미지를 1.png로 변경
        const currentDate = new Date();
        const currentDay = currentDate.getDay(); // 일요일(0)부터 토요일(6)까지 0부터 6까지의 값을 반환합니다.

        const allButtons = document.getElementsByClassName('day-button');
        for (let i = 0; i < allButtons.length; i++) {
            const images = allButtons[i].getElementsByClassName('day-img');

            if ((currentDay + 6) % 7 === i) {
                // 현재 요일 버튼
                images[0].style.display = 'none';
                images[1].style.display = 'block';
            } else {
                // 나머지 요일 버튼
                images[0].style.display = 'block';
                images[1].style.display = 'none';
            }
        }
    }

    function toggleButton(day) {
        // 클릭된 버튼의 이미지를 1.png로 변경
        const clickedButton = document.getElementById(day);
        const images = clickedButton.getElementsByClassName('day-img');
        images[0].style.display = 'none';
        images[1].style.display = 'block';

        // 나머지 버튼들의 이미지를 0.png로 변경
        const allButtons = document.getElementsByClassName('day-button');
        for (let i = 0; i < allButtons.length; i++) {
            if (allButtons[i].id !== day) {
                const otherImages = allButtons[i].getElementsByClassName('day-img');
                otherImages[0].style.display = 'block';
                otherImages[1].style.display = 'none';
            }
        }
    }

    // 초기화 함수 호출
    initButtons();
</script>

<script>

    $(function() {
        // Check if we can access the Geolocation API
        if (navigator.geolocation) {
            // Regularly get location information
            const id = navigator.geolocation.watchPosition(
                function(pos) {
                    $('#latitude').html(pos.coords.latitude); // 위도
                    $('#longitude').html(pos.coords.longitude); // 경도
                });

            // Stop monitoring with button click
            $('#btnStop').click(function() {
                navigator.geolocation.clearWatch(id);
            });
        } else {
            alert("이 브라우저에서는 Geolocation을 지원하지 않습니다.")
        }

    });
</script>
<script>
    const API_KEY = '9d1cf1fe0889f04622c00ea6dbe6c73d';


    function displayWeather(temperature, weather, name) {
        console.log("디스플레이 콘솔"+temperature,weather,name)
        const resultElement = document.getElementById("weatherResult");
        resultElement.innerHTML = `온도: ${temperature}°C, 날씨: ${weather} 접속위치:${name}`;
        const resultTemperature = document.getElementById("temperatureResult");
        resultTemperature.innerHTML = `${temperature}`;
        const resultWeather= document.getElementById("weather2Result");
        resultWeather.innerHTML = `${weather}`;
        const resultLocation= document.getElementById("locationResult");
        resultLocation.innerHTML = `${name}`;

        const icon = document.getElementById("icon");
        const weatherIconElement = document.createElement("img");
        weatherIconElement.classList.add("weather-icon");
        weatherIconElement.style.width = "45px"; // 가로 크기 설정
        weatherIconElement.style.height = "45px"; // 세로 크기 설정
        const iconFileName = getIconFileName(weather);
        weatherIconElement.src = `/img/${iconFileName}`;

        icon.appendChild(weatherIconElement);
    }

    function getIconFileName(weather) {
        const weatherIcons = {
            "Clear": "Clear4.png",
            "Clouds": "Clouds4.png",
            "Rain": "Rain4.png",
            "Snow": "Snow4.png"
        };

        const weatherKey = Object.keys(weatherIcons).find(key => weather.includes(key));

        return weatherIcons[weatherKey];
    }

    function getWeather() {
        if (navigator.geolocation) {
            navigator.geolocation.getCurrentPosition(position => {
                const latitude = position.coords.latitude;
                const longitude = position.coords.longitude;

                fetch(
                    `https://api.openweathermap.org/data/2.5/weather?lat=${latitude}&lon=${longitude}&appid=${API_KEY}&units=metric`
                )
                    .then(response => response.json())
                    .then(data => {
                        const temperature = data.main.temp; // 온도
                        let weather;

                        if (data.weather[0].main === "Mist" || data.weather[0].main === "Thunderstorm") {
                            weather = "Rain";
                        } else {
                            weather = data.weather[0].main;
                        } // 날씨 조건
                        const name = data.name; // 날씨 조건
                        displayWeather(temperature, weather, name);

                    })
                    .catch(error => {
                        alert("날씨 정보를 가져오는 중에 오류가 발생했습니다.");
                    });
            }, () => {
                alert("위치 정보를 찾을 수 없습니다. 날씨 정보를 제공할 수 없습니다.");
            });
        } else {
            alert("이 브라우저에서는 Geolocation을 지원하지 않습니다. 날씨 정보를 제공할 수 없습니다.");
        }
    }

    // 정해진 간격으로 실시간으로 날씨 정보 업데이트
    setInterval(getWeather, 60000); // 1분마다 업데이트

    // 페이지 로드 시 초기 날씨 정보 출력
    window.onload = getWeather;
</script>


</html>